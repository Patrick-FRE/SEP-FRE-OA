<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="./assignment.css">
    <title>Document</title>
</head>
<body>
    <div class='container'>
        <header class="header">
            To do List
            <input type="text" name="inputAdd" id="inputAdd">
            <button id="fetch" value="fetch">Fetch</button>
        </header>
        <div class='menu' id='menu'>
            <ul id="myUL">
            </ul>
        </div>
        <div class='content'>
            <div class="text">
                <table id='tableshow'>

                </table>
            </div>
        </div>
    </div>

    <script>
        var id = 0;
        function todo(){
            var input = document.querySelector("input[type='text']");
            var ul = document.querySelector('#myUL');
            input.addEventListener('keypress',(e)=>{
                var key = e.which || e.keyCode;
                if(key == 13)
                {
                    let text = input.value;
                    var node = document.createTextNode(text);
                    var li = document.createElement('li');
                    var btn = document.createElement('button');
                    btn.innerText = 'Delete';
                    // btn.type = 'button';
                    // btn.value = 'Delete';
                    // btn.id = ""+id;
                    // btn.onclick = function() {clickEvent(this.id)};   //mark!!!!!!!!
                    li.appendChild(node);
                    li.appendChild(btn);
                    ul.appendChild(li);
                    input.value = "";
                    id++;
                }
            })
        }
        function clickEvent(){
            // var btn = document.querySelector('#button'+id);    // ??????
            var menu = document.getElementById('menu');
            menu.addEventListener('click',function(){
                console.log(event.target.tagName);
                if(event.target.tagName == 'BUTTON')
                    event.target.parentElement.parentElement.removeChild(event.target.parentElement);
            })
            // btn.parentElement.parentElement.removeChild(btn.parentElement);    //compare to display none, this could be better!
            // console.log(btn);
        }
        function myFetch(){
            var id = 0;
            var btn = document.querySelector('#fetch');
            var table = document.querySelector('#tableshow')
            console.log(table);
            btn.addEventListener('click',()=>{
                fetch('https://jsonplaceholder.typicode.com/todos/1')
                .then(response => response.json())
                .then(json => {
                    // console.log(typeof json);
                    console.log(json);
                    // console.log(json.userId);
                    var tr = document.createElement('tr');
                    if(id == 0){
                        var headTr = document.createElement('tr');
                        Object.keys(json).forEach(function(key){
                            var td = document.createElement('td');
                            var headTd = document.createElement('td');
                            var text = document.createTextNode(json[key]);
                            var headText = document.createTextNode(key);
                            headTd.appendChild(headText);
                            td.appendChild(text);
                            headTr.appendChild(headTd);
                            tr.appendChild(td);

                            console.log(key);
                            console.log(json[key]);
                        });
                        table.appendChild(headTr);
                        table.appendChild(tr);
                    }
                    else{
                        Object.keys(json).forEach(function(key){
                            var td = document.createElement('td');             
                            var text = document.createTextNode(json[key]);
                            td.appendChild(text);
                            tr.appendChild(td);
                        });
                        table.appendChild(tr);
                    }
                    id++;

                })
            })
        }


        todo();
        myFetch();
        clickEvent();
    </script>

</body>
</html>