<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="./assignment.css">
    <title>Document</title>
</head>
<body>
    <div class='container'>
        <header class="header">
            To do List
            <input type="text" name="inputAdd" id="inputAdd">
            <button id="fetch" value="fetch">Fetch</button>
            <input type="checkbox" name="check1" id="check1">
            <label for="check1">HAHAHA</label>
            <input type="checkbox" name="check1" id="check2">
            <label for="check2">HEHEHE</label>
            <input type="checkbox" name="check1" id="check3">
            <label for="check3">HEIHEIHEI</label>
            <input type="checkbox" name="check1" id="check4">
            <label for="check4">WOWOWO</label>
            <br>
            <br>
            <input type="text" name="inputcheck" id="inputcheck">
            <input type="checkbox" name="checkcheck1" id="checkcheck1">
            <label for="check1">WANGWANG</label>
            <input type="checkbox" name="checkcheck2" id="checkcheck2">
            <label for="check2">MEWMEW</label>
            <input type="checkbox" name="checkcheck3" id="checkcheck3">
            <label for="check3">KEKE</label>
            <input type="checkbox" name="checkcheck4" id="checkcheck4">
            <label for="check4">ZIZI</label>
        </header>
        <div class='menu'>
            <ul id="myUL">
            </ul>
        </div>
        <div class='content'>
            <div class="text">
                <table id='tableshow'>
                </table>
            </div>
        </div>
    </div>

    <script>
        var id = 0;
        function todo(){
            var input = document.querySelector("input[type='text']");
            var ul = document.querySelector('#myUL');
            input.addEventListener('keypress',(e)=>{
                var key = e.which || e.keyCode;
                if(key == 13)
                {
                    let text = input.value;
                    var node = document.createTextNode(text);
                    var li = document.createElement('li');
                    var btn = document.createElement('input');
                    btn.type = 'button';
                    btn.value = 'Delete';
                    btn.id = ""+id;
                    // btn.onclick = function() {clickEvent(this.id)};   //mark!!!!!!!!
                    btn.addEventListener('click',function(){
                      this.parentElement.parentElement.removeChild(this.parentElement);
                    })
                    li.appendChild(node);
                    li.appendChild(btn);
                    ul.appendChild(li);
                    input.value = "";
                    id++;
                }
            })
        }
        function myFetch(){
            var id = 0;
            var btn = document.querySelector('#fetch');
            var table = document.querySelector('#tableshow')
            console.log(table);
            btn.addEventListener('click',()=>{
                fetch('https://jsonplaceholder.typicode.com/todos/1')
                .then(response => response.json())
                .then(json => {
                    // console.log(typeof json);
                    console.log(json);
                    // console.log(json.userId);
                    var tr = document.createElement('tr');
                    if(id == 0){
                        var headTr = document.createElement('tr');
                        Object.keys(json).forEach(function(key){
                            var td = document.createElement('td');
                            var headTd = document.createElement('td');
                            var text = document.createTextNode(json[key]);
                            var headText = document.createTextNode(key);
                            headTd.appendChild(headText);
                            td.appendChild(text);
                            headTr.appendChild(headTd);
                            tr.appendChild(td);

                            console.log(key);
                            console.log(json[key]);
                        });
                        table.appendChild(headTr);
                        table.appendChild(tr);
                    }
                    else{
                        Object.keys(json).forEach(function(key){
                            var td = document.createElement('td');             
                            var text = document.createTextNode(json[key]);
                            td.appendChild(text);
                            tr.appendChild(td);
                        });
                        table.appendChild(tr);
                    }
                    id++;

                })
            })
        }

        function myCheckbox(){
            var checkboxs = document.querySelectorAll('input[type=checkbox]');
            // for(cb in checkboxs){
            //   console.log(cb);
            // }
            for(var i = 0; i < checkboxs.length; i++)
            {
               checkboxs[i].id = i;
               checkboxs[i].addEventListener('change', function(){
                 if(this.checked){
                    // console.log(this.id);
                    var cbs = document.querySelectorAll('input[type=checkbox]');
                    for(let j = 0; j < cbs.length; j++)
                        if(j != this.id)
                          cbs[j].checked = false;
                  }
               })
            }
        }
        // use function(e) and () => {} "this" is different
        function numberCheck(){
            var input = document.querySelector('#inputcheck');
            input.addEventListener('keypress',function(e) {
                var keycode = e.keyCode;
                if(keycode == 13)
                { 
                  let total = this.value;
                  let cbs = document.querySelectorAll("input[name*='checkcheck']");
                  // let checknum = total%(cbs.length*2);
                  // let reverse = checknum <= cbs.length ? 0:1;
                  // console.log(checknum);
                  // console.log(reverse);
                  // if(reverse)
                  // {  
                  //   for(let i = 0; i < checknum-cbs.length; i++)
                  //       cbs[cbs.length-1-i].checked = true;
                  // }
                  // else
                  // {
                  //   for(let i = 0; i < checknum; i++)
                  //       cbs[i].checked = true;
                  // }
                  // console.log(cbs); 
                  for(let i = 0; i < total; i++)
                     if(cbs[i%cbs.length].checked)
                        cbs[i%cbs.length].checked = false;
                     else
                        cbs[i%cbs.length].checked = true;
                }
            })
        }


        todo();
        myFetch();
        myCheckbox();
        numberCheck();
    </script>

</body>
</html>