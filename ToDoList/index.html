<!DOCTYPE html>
 <html class="no-js"> 
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="">
        <style>
            *{
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            .lists-container{
                display: flex;
                margin:2rem auto;
                padding: 1rem;
                
            }

            .container{
                border:1px solid black;
                border-radius: .25rem;
                width: 100%;
                margin:0 5rem;
                display: flex;
                flex-direction: column;
                align-items: center;
                padding:1rem;
            }

            .container input{
                font-size: 1.1rem;
                padding:1rem;
            }

            .container ul{
                margin: 5px auto
            }
            .container ul li{
                margin: 5px;
                font-size: 1rem;
                cursor: pointer;
            }

            ul li .completed{
                border: 1px solid red;
            }

            .todo-status{
                display: flex;
                flex-direction: column;
                justify-content: space-around;
            }

            .todo-status input{
                font-size: 1.2rem;
                padding: 1.1rem;
            }
        </style>
    </head>
    <body>
        <main>
            <section class="lists-container">
                <div class='container'>
                    <div>
                        <header>To Do List</header>
                    </div>
                    <div>
                        <input type="text" class="todolist_inputBar" id="todoInput"placeholder="Enter you To Do Here....">
                    </div>
                    <div>
                        <ul class="todolist_content" id="todolist_content">

                        </ul>
                    </div>
                    <div>
                        <select id="todo-selects">

                        </select>
                    </div>
                </div>

                <div class="todo-status">
                    <input type="button" id="btn-completed"  value="Completed ToDo">
                    <input type="button" id="btn-uncompleted" value="Not Completed">
                </div>
                <div class="container">
                    <div>
                        <header>Finished List</header>
                    </div>
                    <div>
                        <ul id="completed-list">

                        </ul>
                    </div>
                    <div>
                        <select>

                        </select>
                    </div>
                </div>
            </section>
        </main>
        
        <script>
            const Model = (function(){
                class ToDoItem{
                    constructor(todoText){
                        this.todoText = todoText;
                    }
                    generateToDoTemplate(){
                        return `<li>${this.todoText}
                                <span><input type="button" 
                                    class="btn-removeTodo"  
                                    id=${this.todoText} 
                                    value="Remove">
                                </span>
                            </li>`
                    }
                    
                    
                }
                return {
                    ToDoItem
                };
            })();

            const View =( function(){
                const DOMstring={
                    todoList:'#todolist_content',
                    todoInput:'.todolist_inputBar',
                };
                return {
                    DOMstring
                }
            })(); //IIFE Immediately Invoked Function Expression

            const Controller = (function(view,model){
                const render = function (template, element) {
                    element.innerHTML = template;
                }
                class State{
                    constructor(){
                        this._todoList = []
                    }

                    get todoList(){
                        console.log('GET todolist')
                        return this._todoList;
                    }

                    set todoList(newValue){
                        console.log('SET todolist');
                        console.log('newValue:', newValue);
                        this._todoList = newValue;
                        let tmp = newValue
                        .map(todoItem => 
                            todoItem.generateToDoTemplate(),
                     
                        )
                        .join('');
                        render(tmp,elements.todolistElement)
                    }
                }

                let state = new State();

                const elements ={
                    todolistElement: document.querySelector(view.DOMstring.todoList),
                    todolistInput: document.querySelector(view.DOMstring.todoInput),
                    todolistSelectElement: document.getElementById('todo-selects'),
                    completedTodo: document.getElementById('btn-completed')
                }

                const setEvent=()=>{
                    //Add Todo
                    elements.todolistInput.addEventListener('keyup',(e)=>{
                        if(e.keyCode == 13){                  
                            let newTodo = new model.ToDoItem(e.target.value);         
                            state.todoList = [...state.todoList, newTodo];
                            //======add to select===========
                            let option = document.createElement('option');
                            let select = document.getElementById('todo-selects');             
                            option.innerText = e.target.value           
                            // console.log('option',option)
                            select.appendChild(option);
                            //=================
                            e.target.value = '';
                            
                        }else if(e.target.value.length <= '0'){
                            e.preventDefault();
                            console.log("hi")
                        }
                    });
                    
                    //Remove Todo
                    elements.todolistElement.addEventListener("click",(e)=>{
                        if(e.target.className == 'btn-removeTodo'){
                            console.log('target:',e.target);
                         
                            // elements.todolistElement.style.display = "none";
                            state.todoList = state.todoList.filter( todoItem =>{
                                if(todoItem.todoText != e.target.id){
                                    return true
                                }else{
                                    return false
                                }
                            }
                            )
                        } 
                        
                        
                    });

                    //Move to right
                    // elements.completedTodo.addEventListener('click',(e)=>{
                    //     let value = document.getElementById('todo-selects').value
                    //     let parent = value.parentElement;
                    //     let completedList = document.getElementById('completed-list');
                    //     // let li = document.createElement('li');
                    //     // li.innerText = value;
                    //     completedList.appendChild(parent);
                    //     console.log('value',value)
                    // })

                    // //Check Todo
                    // elements.todolistElement.addEventListener('click',(e)=>{
                    //     e.target.classList.add('completed');
                    //     console.log(e.target)
                    //     // if(e.target.className == 'todo-item'){
                    //     //     console.log("checked")
                    //     // }
                    // })
                }

                return {
                    initApp:function(){
                        console.log('Init App');
                        setEvent();
                    }
                }
            })(View,Model);

            //undefined before declare any var inside
            console.log('Model',Model) //Model class ToDoItem{...}
            console.log("View",View) // {DOMstring: {â€¦}}
            console.log('Controller', Controller) //
            Controller.initApp(); //Init App
            
        </script>
    </body>
</html>